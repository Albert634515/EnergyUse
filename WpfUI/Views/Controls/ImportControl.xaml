<UserControl x:Class="WpfUI.Views.Controls.ImportControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid Margin="15">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <ToolBar Grid.Row="0" Margin="0 0 0 15">

            <Button Command="{Binding ImportCommand}">
                <DockPanel>
                    <Image Width="20" Height="20" Source="/WpfUI;component/Resources/download_24x24.png"/>
                    <TextBlock Text="Import" Margin="5,0,0,0"/>
                </DockPanel>
            </Button>

            <Button Command="{Binding RecalculateCommand}">
                <DockPanel>
                    <Image Width="20" Height="20" Source="/WpfUI;component/Resources/settings.png"/>
                    <TextBlock Text="Recalculate" Margin="5,0,0,0"/>
                </DockPanel>
            </Button>

            <Button Command="{Binding SaveCommand}">
                <DockPanel>
                    <Image Width="20" Height="20" Source="/WpfUI;component/Resources/tick-mark_24x24.png"/>
                    <TextBlock Text="Save" Margin="5,0,0,0"/>
                </DockPanel>
            </Button>

        </ToolBar>

        <!-- File selection -->
        <Grid Grid.Row="1" Margin="0 0 0 10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Label Content="Import file:" VerticalAlignment="Center"/>

            <TextBox Grid.Column="1"
                     Margin="10 0"
                     VerticalAlignment="Center"
                     Text="{Binding ImportFile, UpdateSourceTrigger=PropertyChanged}"/>

            <Button Grid.Column="2"
                    Content="Browse..."
                    Command="{Binding BrowseFileCommand}"
                    Margin="10 0"
                    Width="90"/>
        </Grid>

        <!-- Meter selection -->
        <Grid Grid.Row="2" Margin="0 0 0 15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="200"/>
            </Grid.ColumnDefinitions>

            <Label Content="Meter:" VerticalAlignment="Center"/>

            <ComboBox Grid.Column="1"
                      Margin="10 0"
                      ItemsSource="{Binding Meters}"
                      SelectedItem="{Binding SelectedMeter}"
                      DisplayMemberPath="Description"
                      SelectedValuePath="Id"/>
        </Grid>

        <!-- DataGrid -->
        <DataGrid Grid.Row="3"
                  ItemsSource="{Binding MeterReadings}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False">

            <!-- Rij-kleur zonder converter -->
            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Setter Property="Background" Value="Azure"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Id}" Value="{x:Null}">
                            <Setter Property="Background" Value="LightGreen"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>

            <DataGrid.Columns>

                <DataGridTextColumn Header="Date" Binding="{Binding RegistrationDate}" Width="120"/>

                <DataGridTextColumn Header="Rate Normal" Binding="{Binding RateNormal}" Width="120"/>

                <!-- Delta Normal -->
                <DataGridTextColumn Header="Delta Normal" Binding="{Binding DeltaNormal}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Padding" Value="4"/>
                            <Setter Property="Background" Value="White"/>

                            <Style.Triggers>

                                <!-- Negatief -->
                                <DataTrigger Binding="{Binding DeltaNormal, StringFormat={}{0}}" Value="-">
                                    <Setter Property="Background" Value="LightCoral"/>
                                </DataTrigger>

                                <!-- Positief -->
                                <DataTrigger Binding="{Binding DeltaNormal, StringFormat={}{0}}" Value="0">
                                    <Setter Property="Background" Value="White"/>
                                </DataTrigger>

                                <!-- Positief (niet 0 en niet negatief) -->
                                <DataTrigger Binding="{Binding DeltaNormal, StringFormat={}{0}}" Value="">
                                    <Setter Property="Background" Value="LightGreen"/>
                                </DataTrigger>

                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="Rate Low" Binding="{Binding RateLow}" Width="120"/>

                <!-- Delta Low -->
                <DataGridTextColumn Header="Delta Low" Binding="{Binding DeltaLow}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Padding" Value="4"/>
                            <Setter Property="Background" Value="White"/>

                            <Style.Triggers>

                                <DataTrigger Binding="{Binding DeltaLow, StringFormat={}{0}}" Value="-">
                                    <Setter Property="Background" Value="LightCoral"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding DeltaLow, StringFormat={}{0}}" Value="0">
                                    <Setter Property="Background" Value="White"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding DeltaLow, StringFormat={}{0}}" Value="">
                                    <Setter Property="Background" Value="LightGreen"/>
                                </DataTrigger>

                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="Return Low" Binding="{Binding ReturnDeliveryLow}" Width="120"/>

                <!-- Return Δ Low -->
                <DataGridTextColumn Header="Return Δ Low" Binding="{Binding ReturnDeliveryDeltaLow}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Padding" Value="4"/>
                            <Setter Property="Background" Value="White"/>

                            <Style.Triggers>

                                <DataTrigger Binding="{Binding ReturnDeliveryDeltaLow, StringFormat={}{0}}" Value="-">
                                    <Setter Property="Background" Value="LightCoral"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ReturnDeliveryDeltaLow, StringFormat={}{0}}" Value="0">
                                    <Setter Property="Background" Value="White"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ReturnDeliveryDeltaLow, StringFormat={}{0}}" Value="">
                                    <Setter Property="Background" Value="LightGreen"/>
                                </DataTrigger>

                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="Return Normal" Binding="{Binding ReturnDeliveryNormal}" Width="120"/>

                <!-- Return Δ Normal -->
                <DataGridTextColumn Header="Return Δ Normal" Binding="{Binding ReturnDeliveryDeltaNormal}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Padding" Value="4"/>
                            <Setter Property="Background" Value="White"/>

                            <Style.Triggers>

                                <DataTrigger Binding="{Binding ReturnDeliveryDeltaNormal, StringFormat={}{0}}" Value="-">
                                    <Setter Property="Background" Value="LightCoral"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ReturnDeliveryDeltaNormal, StringFormat={}{0}}" Value="0">
                                    <Setter Property="Background" Value="White"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ReturnDeliveryDeltaNormal, StringFormat={}{0}}" Value="">
                                    <Setter Property="Background" Value="LightGreen"/>
                                </DataTrigger>

                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="Id" Binding="{Binding Id}" Width="80"/>

            </DataGrid.Columns>

        </DataGrid>

    </Grid>
</UserControl>
